初めて起動するとき
①サービスに登録する
sc.exe create MonitAI_Service binPath="C:\Users\it222104\source\repos\MonitAI_System\MonitAIサービス完成版\MonitAI_Service\MonitAI_Service\bin\Release\net8.0\MonitAI_Service.exe"


②サービスを起動させる
③再起動や停止無効を機能させる

Start-Service -Name MonitAI_Service
sc.exe failure MonitAI_Service reset=1 actions=restart/1000/restart/1000/restart/1000
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MonitAI_Service" `
/v AllowStop `
/t REG_DWORD `
/d 0 `
/f


 (Get-WmiObject Win32_Service -Filter "Name='MonitAI_Service'").PathName
このコードはMonitAI_Service.exeがどこにあるのかを知るコード



MonitAI_serviceを止める方法

PowerShell（管理者）で3つのコードを打つ
①再起動を停止させる
②停止禁止を解除する
③サービス本体を停止する

sc.exe failure MonitAI_Service reset=1 actions=//
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MonitAI_Service" `
/v AllowStop `
/t REG_DWORD `
/d 1 `
/f
Stop-Service -Name MonitAI_Service -Force

④もし止まらなかったら
　taskkill /IM MonitAI_Service.exe /F

taskkill /F /IM "WindowsSystems.exe"; sc.exe delete "WindowsSystems"
taskkill /F /IM "WindowsTimer.exe"; sc.exe delete "WindowsTimer"
taskkill /F /IM "MonitAI_Service.exe"; sc.exe delete "MonitAI_Service"


上書き
ヴィジュアルスタジオでソリューション構成を「Release」に変更→ビルド→ソリューションのビルドを行う



MonitAI_Serviceを起動させる
PowerShell（管理者）で3つのコードを打つ
①再起動を復活させる
②停止禁止を復活
③サービスを開始する

sc.exe failure MonitAI_Service reset=1 actions=restart/1000/restart/1000/restart/1000
reg add "HKLM\SYSTEM\CurrentControlSet\Services\MonitAI_Service" `
/v AllowStop `
/t REG_DWORD `
/d 0 `
/f
Start-Service -Name MonitAI_Service
Start-Service -Name WindowsSystems
